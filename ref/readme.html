<h1 id="knx-net-nuget-version-https-badge-fury-io-nu-knx-net-svg-https-badge-fury-io-nu-knx-net-">KNX.net <a href="https://badge.fury.io/nu/KNX.net"><img src="https://badge.fury.io/nu/KNX.net.svg" alt="NuGet version"></a></h1>
<p>KNX.net provides a <a href="http://en.wikipedia.org/wiki/KNX_%28standard%29">KNX</a> API for C#</p>
<p>This API allows to connect in both modes:</p>
<ul>
<li>Tunneling</li>
<li>Routing</li>
</ul>
<p>After connecting you will be able to send actions to the bus and receive messages from it.</p>
<p>The following datapoints are available in the API:</p>
<table>
<thead>
<tr>
<th>DPT</th>
<th>input type</th>
<th>input range</th>
<th>output type</th>
<th>output range</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>3.007</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[-7,7]</code></td>
<td><code>int</code></td>
<td><code>[-7,7]</code></td>
<td>Control blinds (steps) [<code>0</code> stops]</td>
</tr>
<tr>
<td><code>3.008</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[-7,7]</code></td>
<td><code>int</code></td>
<td><code>[-7,7]</code></td>
<td>Control dimming (steps) [<code>0</code> stops]</td>
</tr>
<tr>
<td><code>5.001</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[0,100]</code></td>
<td><code>decimal</code></td>
<td><code>[0,100]</code></td>
<td>Percentage (%)</td>
</tr>
<tr>
<td><code>5.003</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[0,360]</code></td>
<td><code>decimal</code></td>
<td><code>[0,360]</code></td>
<td>Angle (°)</td>
</tr>
<tr>
<td><code>5.004</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[0,255]</code></td>
<td><code>int</code></td>
<td><code>[0,255]</code></td>
<td>Percentage <code>[0,255]</code> (%)</td>
</tr>
<tr>
<td><code>5.010</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[0,255]</code></td>
<td><code>int</code></td>
<td><code>[0,255]</code></td>
<td>Counter Pulses</td>
</tr>
<tr>
<td><code>6.001</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[-128,127]</code></td>
<td><code>int</code></td>
<td><code>[-128,127]</code></td>
<td>Percentage (%)</td>
</tr>
<tr>
<td><code>6.010</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[-128,127]</code></td>
<td><code>int</code></td>
<td><code>[-128,127]</code></td>
<td>Counter Pulses</td>
</tr>
<tr>
<td><code>9.001</code></td>
<td><code>int</code>, <code>float</code>, <code>long</code>, <code>double</code>, <code>decimal</code></td>
<td><code>[-273,670760]</code></td>
<td><code>decimal</code></td>
<td><code>[-273,670760]</code></td>
<td>Temperature in Celsius (°C)</td>
</tr>
</tbody>
</table>
<p>Also working but no implemented as datapoints (see below for better explanation):</p>
<ul>
<li>bit (lights, buttons)</li>
<li>byte (dimmers, temperature difference, RGB)</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="connecting-using-routing-turn-off-and-on-a-light-">Connecting using Routing (turn off and on a light)</h3>
<pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)
</span>{
  <span class="hljs-keyword">var</span> connection = <span class="hljs-keyword">new</span> KnxConnectionRouting();
  connection.Connect();
  connection.KnxEventDelegate += Event;
  connection.Action(<span class="hljs-string">"5/0/2"</span>, <span class="hljs-keyword">false</span>);
  Thread.Sleep(<span class="hljs-number">5000</span>);
  connection.Action(<span class="hljs-string">"5/0/2"</span>, <span class="hljs-keyword">true</span>);
  Thread.Sleep(<span class="hljs-number">5000</span>);
}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Event</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> address, <span class="hljs-keyword">string</span> state</span>)
</span>{
  Console.WriteLine(<span class="hljs-string">"New Event: device "</span> + address + <span class="hljs-string">" has status "</span> + state);
}
</code></pre>
<h3 id="working-with-datapoints">Working with datapoints</h3>
<p>Sending an action</p>
<pre><code class="hljs csharp">connection.Action(<span class="hljs-string">"1/1/16"</span>, connection.ToDataPoint(<span class="hljs-string">"9.001"</span>, <span class="hljs-number">24.0</span>f));
connection.Action(<span class="hljs-string">"1/1/17"</span>, connection.ToDataPoint(<span class="hljs-string">"5.001"</span>, <span class="hljs-number">50</span>));
</code></pre>
<p>Converting state from event</p>
<pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Event</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> address, <span class="hljs-keyword">string</span> state</span>)
</span>{
  <span class="hljs-keyword">if</span> (address == <span class="hljs-string">"1/1/16"</span>)
  {
    <span class="hljs-keyword">decimal</span> temp = (<span class="hljs-keyword">decimal</span>)connection.FromDataPoint(<span class="hljs-string">"9.001"</span>, state);
    Console.WriteLine(<span class="hljs-string">"New Event: device "</span> + address + <span class="hljs-string">" has status "</span> + temp);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (address == <span class="hljs-string">"1/1/17"</span>)
  {
    <span class="hljs-keyword">int</span> perc = (<span class="hljs-keyword">int</span>)connection.FromDataPoint(<span class="hljs-string">"5.001"</span>, state);
    Console.WriteLine(<span class="hljs-string">"New Event: device "</span> + address + <span class="hljs-string">" has status "</span> + perc);
    <span class="hljs-keyword">return</span>;
  }
}
</code></pre>
<h3 id="requesting-status">Requesting status</h3>
<p>Sending an action</p>
<pre><code class="hljs csharp">connection.KnxStatusDelegate += Status;
connection.RequestStatus(<span class="hljs-string">"1/1/16"</span>);
connection.RequestStatus(<span class="hljs-string">"1/1/17"</span>);
</code></pre>
<p>Converting state from status event</p>
<pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Status</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> address, <span class="hljs-keyword">string</span> state</span>)
</span>{
  <span class="hljs-keyword">if</span> (address == <span class="hljs-string">"1/1/16"</span>)
  {
    <span class="hljs-keyword">decimal</span> temp = (<span class="hljs-keyword">decimal</span>)connection.FromDataPoint(<span class="hljs-string">"9.001"</span>, state);
    Console.WriteLine(<span class="hljs-string">"New Event: device "</span> + address + <span class="hljs-string">" has status "</span> + temp);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (address == <span class="hljs-string">"1/1/17"</span>)
  {
    <span class="hljs-keyword">int</span> perc = (<span class="hljs-keyword">int</span>)connection.FromDataPoint(<span class="hljs-string">"5.001"</span>, state);
    Console.WriteLine(<span class="hljs-string">"New Event: device "</span> + address + <span class="hljs-string">" has status "</span> + perc);
    <span class="hljs-keyword">return</span>;
  }
}
</code></pre>
<h3 id="sending-actions-without-using-datapoints">Sending actions without using datapoints</h3>
<pre><code class="hljs csharp">connection.Action(<span class="hljs-string">"1/1/19"</span>, <span class="hljs-keyword">true</span>);
connection.Action(<span class="hljs-string">"1/1/20"</span>, <span class="hljs-keyword">false</span>);
connection.Action(<span class="hljs-string">"1/1/21"</span>, <span class="hljs-number">60</span>);
connection.Action(<span class="hljs-string">"1/1/22"</span>, <span class="hljs-number">0x4E</span>);
</code></pre>
<h3 id="connecting-using-tunneling">Connecting using Tunneling</h3>
<p>The only difference is how the connection object is created</p>
<pre><code class="hljs csharp">connection = <span class="hljs-keyword">new</span> KNXConnectionTunneling(remoteIP, remotePort, localIP, localPort);
</code></pre>
<h3 id="notes">Notes</h3>
<p>If connecting in routing mode:</p>
<ul>
<li>make sure the system firewall allows incoming connections to the routing port (if not specified when connecting, default is <code>3671</code>)</li>
</ul>
<p>If connecting in tunneling mode:</p>
<ul>
<li>make sure the system firewall allows incoming connections to the specified <code>localPort</code></li>
</ul>
